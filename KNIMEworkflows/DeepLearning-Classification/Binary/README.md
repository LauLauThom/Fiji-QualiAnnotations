# Binary classification
This directory contains 2 workflows :
- one for the training of the deep-learning model for binary image-classication  
- the second for the prediction of image-classes for new images using the trained model

__NB__: Binary classification means that there are 2 possible categories for images only, therefore the category column of the annotation table
should contain only 2 possible values. For more categories use the Multi-Class workflow.

The training workflow is inspired by the KNIME example workflow by Christian Dietz for the cats and dog Kaggle classification challenge ([Fine-tune VGG16](https://kni.me/w/EUWPBdnVuIxuFMGf)).

## Training
The workflow takes as input an annotation table as generated by the "Button" Fiji plugin, with a single category column.  
The workflow takes care of image pre-processing (resizing, intensity normalization, RGB conversion).  
The parameters for the training (number of epochs, batch size, learning rate...) can be adjusted in the Keras Network Learner node.  
The progress of the training can be monitored live.  
After the training has completed, the trained model can be saved as a h5 file to use for prediction of image-categories on new images.  
Exporting the model also export a text file with class names. Both files (h5 and txt) are necessary for the prediction.  

## Example
You can use the [example dataset](http://doi.org/10.5281/zenodo.3997728) uploaded to Zenodo to experiment with the workflow.
The Zenodo upload contains both the ground-truth images and the ground-truth categories in a csv table that can be loaded directly in the workflow.  
It also contains a pre-trained model (h5 file + text file with class names) that can be loaded in the prediction workflow.  
